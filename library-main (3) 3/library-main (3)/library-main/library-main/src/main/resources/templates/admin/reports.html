<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Library Reports</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <script type="text/javascript" src="https://public.tableau.com/javascripts/api/tableau-2.min.js"></script>
  <style>
    body {
        background: linear-gradient(to right, #e6d5b8, #f3efe0);
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        color: #3d3d3d;
        min-height: 100vh;
    }
    .container {
        max-width: 900px;
        margin: auto;
        margin-top: 60px;
        text-align: center;
    }
    h1 {
        font-weight: bold;
        color: #5a3e2b;
    }
    .report-container {
        position: relative;
        max-width: 100%;
        height: 600px;
        margin: auto;
    }
    .btn-nav {
        background: #8b4513;
        color: white;
        border: none;
        border-radius: 8px;
        padding: 10px 20px;
        transition: background 0.3s ease;
        margin: 10px;
    }
    .btn-nav:hover {
        background: #5a3e2b;
    }
  </style>
</head>
<body>

<div class="container">
  <h1>ðŸ“Š Library Reports</h1>
  <h5 id="report-title">ðŸ“Œ Report 1</h5>
  <p id="report-description">Most Issued Genre.</p>
  <div class="report-container" id="viz-container"></div>

  <div class="text-center mt-4">
    <button class="btn btn-nav" onclick="prevReport()">â¬… Previous</button>
    <button class="btn btn-nav" onclick="nextReport()">Next âž¡</button>
  </div>
</div>

<script>
  let currentSheetIndex = 0;
  const sheets = ["Sheet1", "Sheet2", "Sheet3"];
  const sheetTitles = ["ðŸ“Œ Report 1", "ðŸ“Œ Report 2", "ðŸ“Œ Report 3"];
  const sheetDescriptions = ["Most Issued Genre", "Books Issued per User", "Overdue Books and Fines"];
  const vizContainer = document.getElementById("viz-container");
  let viz;

  function loadTableauReport(sheetIndex) {
      document.getElementById("report-title").innerText = sheetTitles[sheetIndex];
      document.getElementById("report-description").innerText = sheetDescriptions[sheetIndex];

      const url = "https://public.tableau.com/views/Dashboard1_17416774691040/" + sheets[sheetIndex];

      if (viz) {
          viz.dispose(); // Clear existing report before loading new one
      }

      let options = {
          hideTabs: true,
          hideToolbar: false,
          width: "100%",
          height: "600px"
      };

      viz = new tableau.Viz(vizContainer, url, options);
  }

  function nextReport() {
      currentSheetIndex = (currentSheetIndex + 1) % sheets.length;
      loadTableauReport(currentSheetIndex);
  }

  function prevReport() {
      currentSheetIndex = (currentSheetIndex - 1 + sheets.length) % sheets.length;
      loadTableauReport(currentSheetIndex);
  }

  document.addEventListener("DOMContentLoaded", function () {
      loadTableauReport(currentSheetIndex);
  });
</script>

</body>
</html>
